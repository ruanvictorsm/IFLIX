<!-- IFLIX - Painel do Administrador (versÃ£o cinema) NÃƒO VAI SER UTILIZADO NO PROJETO -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>IFLIX - Admin</title>
  <link rel="stylesheet" href="css/teste.css">
  <link rel="icon" href="Imagens/logomarca.png">
  <meta name="theme-color" content="#141414">
</head>
<body>

  <aside class="lateral">
    <div class="logo">IFLIX</div>

    <div class="perfil">
      <img src="Imagens/adm.png" alt="Foto">
      <span>Administrador</span>
    </div>

    <div class="busca">
      <input type="text" placeholder="Buscar menu">
    </div>

    <nav class="menu">
      <ul>
        <li onclick="window.location.href='gerente.html'">ğŸ  InÃ­cio</li>
        <details>
          <summary>ğŸ“„ CatÃ¡logo</summary>
          <li onclick="document.getElementById('sec-crud').scrollIntoView({behavior:'smooth'})">ğŸ¥ Gerenciar filmes</li>
          <li onclick="window.location.href='projeto.html'">ğŸ¿ Vitrine (pÃºblico)</li>
        </details>
        <li onclick="alert('Em breve: gestÃ£o de usuÃ¡rios.')">ğŸ§‘â€ğŸ’¼ UsuÃ¡rios</li>
        <li onclick="alert('Em breve: relatÃ³rios e insights.')">ğŸ“ˆ Insights</li>
        <li style="color: #e50914" onclick="window.location.href='index.html'">ğŸšª Sair</li>
      </ul>
    </nav>
  </aside>

  <main class="conteudo">

    <!-- ====== Novidades do catÃ¡logo ====== -->
    <div class="linha">
      <section class="secao">
        <h2>Novidades do catÃ¡logo</h2>
        <div class="bloco azul">
          <p>
            <strong id="novidades-num">0</strong> novos tÃ­tulos adicionados nesta semana.
            <br>
            <small id="novidades-info" style="opacity:.85">Atualizado em tempo real com base nas inserÃ§Ãµes do banco.</small>
          </p>
          <div class="botoes" style="margin-top:10px">
            <button class="cinza" onclick="document.getElementById('cards').scrollIntoView({behavior:'smooth'})">Ver novidades</button>
            <button class="cinza" onclick="window.location.href='projeto.html'">Abrir vitrine</button>
          </div>
        </div>
      </section>

      <!-- ====== LanÃ§amentos & TendÃªncias ====== -->
      <section class="secao">
        <div class="cartao">
          <h3>LanÃ§amentos & TendÃªncias</h3>
          <div class="botoes">
            <button class="verde" onclick="document.getElementById('form-filme').scrollIntoView({behavior:'smooth'})">+ Adicionar tÃ­tulo</button>
            <button class="cinza" onclick="alert('Em breve: ranking semanal!')">Ranking semanal</button>
            <button class="cinza" onclick="alert('Em breve: trailers automÃ¡ticos!')">Trailer finder</button>
          </div>
        </div>
      </section>
    </div>

    <!-- ====== Minhas preferÃªncias ====== -->
    <div class="linha">
      <section class="secao">
        <h2>Minhas preferÃªncias</h2>
        <div class="bloco vermelho" style="border-style:solid;border-width:1px;">
          <p>Escolha seus estilos favoritos para personalizar as recomendaÃ§Ãµes:</p>
          <div class="botoes" id="chips-preferencias" style="margin-top:10px">
            <!-- chips gerados pelo JS -->
          </div>
          <small id="prefs-msg" style="display:block;margin-top:8px;opacity:.8"></small>
        </div>
      </section>
    </div>

    <!-- ====== Explorar catÃ¡logos ====== -->
    <div class="linha">
      <section class="secao ensino">
        <div class="cartao">
          <h3>Explorar catÃ¡logos</h3>
          <div class="botoes">
            <button onclick="alert('Em breve: recomendaÃ§Ãµes personalizadas!')">âœ¨ RecomendaÃ§Ãµes pra vocÃª</button>
            <button onclick="alert('Em breve: hub Marvel!')">ğŸ¦¸ Universo Marvel</button>
            <button onclick="alert('Em breve: hub DC!')">ğŸ¦‡ Universo DC</button>
            <button onclick="alert('Em breve: hub de animes!')">ğŸ¥ Anime</button>
            <button onclick="alert('Em breve: comÃ©dias em alta!')">ğŸ˜‚ ComÃ©dia</button>
            <button onclick="alert('Em breve: lista de clÃ¡ssicos!')">ğŸ ClÃ¡ssicos</button>
            <button onclick="alert('Em breve: docs imperdÃ­veis!')">ğŸ¬ DocumentÃ¡rios</button>
          </div>
        </div>
      </section>

      <section class="secao servico">
        <div class="cartao">
          <h3>Ferramentas do cinÃ©filo</h3>
          <div class="botoes">
            <button onclick="alert('Em breve: sua watchlist!')">ğŸ“ Lista de desejos</button>
            <button onclick="alert('Em breve: histÃ³rico inteligente!')">ğŸ•’ HistÃ³rico</button>
            <button onclick="alert('Em breve: exportaÃ§Ã£o CSV!')">ğŸ“¤ Exportar catÃ¡logo</button>
            <button onclick="alert('Em breve: modo apresentaÃ§Ã£o!')">ğŸ–¥ Modo apresentaÃ§Ã£o</button>
          </div>
        </div>
      </section>
    </div>

    <!-- ====== CRUD de Filmes ====== -->
    <section id="sec-crud" class="secao" style="max-width:900px;margin:24px auto;background:#1b1b1b;border:1px solid #2a2a2a;border-radius:14px;padding:16px">
      <h2 style="margin:0 0 10px 0">Gerenciar filmes</h2>

      <form id="form-filme" style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;align-items:start">
        <input id="titulo" placeholder="TÃ­tulo" required style="padding:10px;border-radius:10px;border:1px solid #2a2a2a;background:#121212;color:#fff;grid-column:span 2;">
        <input id="genero" placeholder="GÃªnero" style="padding:10px;border-radius:10px;border:1px solid #2a2a2a;background:#121212;color:#fff;">
        <input id="ano" type="number" placeholder="Ano" style="padding:10px;border-radius:10px;border:1px solid #2a2a2a;background:#121212;color:#fff;">
        <input id="poster" placeholder="URL do poster" style="padding:10px;border-radius:10px;border:1px solid #2a2a2a;background:#121212;color:#fff;grid-column:span 2;">
        <button type="submit" style="padding:10px 12px;border-radius:10px;border:0;background:linear-gradient(120deg,#e50914,#f40612);color:#fff;font-weight:800;grid-column:span 2;">Inserir</button>
      </form>

      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:14px">
        <h3 style="margin:0;font-size:16px;color:#ddd">CatÃ¡logo</h3>
        <button id="btn-recarregar" style="padding:8px 12px;border-radius:10px;border:1px solid #2a2a2a;background:#242424;color:#fff;">Recarregar</button>
      </div>

      <div id="lista" style="margin-top:10px;color:#ddd"></div>
    </section>

    <section style="max-width:1100px;margin:16px auto">
      <h3 style="margin:0 0 10px 0;font-size:16px;color:#ddd">PrÃ©via em cards</h3>
      <div id="cards" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px"></div>
    </section>
    <!-- ====== /CRUD de Filmes ====== -->

  </main>

  <!-- Reutiliza o app.js para CRUD -->
  <script src="app.js" defer></script>

  <!-- Script leve para novidades da semana + preferÃªncias -->
  <script>
    // Conta quantos tÃ­tulos foram criados nos Ãºltimos 7 dias
    async function atualizarNovidades() {
      try {
        const res = await fetch('/api/filmes');
        const filmes = await res.json();
        const agora = new Date();
        const seteDias = 7 * 24 * 60 * 60 * 1000;
        const novos = (filmes || []).filter(f => {
          const d = f.criado_em ? new Date(f.criado_em) : null;
          return d && (agora - d) <= seteDias;
        });
        document.getElementById('novidades-num').textContent = novos.length;
        document.getElementById('novidades-info').textContent =
          novos.length > 0 ? 'Tem novidade fresquinha no catÃ¡logo! ğŸ¬' : 'Sem novidades nos Ãºltimos 7 dias.';
      } catch(e){
        console.warn('Falha ao obter novidades:', e);
      }
    }

    // PreferÃªncias com localStorage (chips clicÃ¡veis)
    const OPCOES_PREFS = ['AÃ§Ã£o', 'ComÃ©dia', 'Drama', 'FicÃ§Ã£o CientÃ­fica', 'Terror', 'Romance', 'Anime', 'DocumentÃ¡rio', 'Marvel', 'DC'];
    function montarChipsPreferencias(){
      const el = document.getElementById('chips-preferencias');
      if (!el) return;
      el.innerHTML = '';
      const prefsSalvas = new Set(JSON.parse(localStorage.getItem('iflix_prefs') || '[]'));
      OPCOES_PREFS.forEach(nome => {
        const b = document.createElement('button');
        b.textContent = nome;
        b.className = 'cinza';
        b.style.borderRadius = '999px';
        b.style.border = '1px solid #333';
        b.style.background = prefsSalvas.has(nome) ? '#262626' : '#1f1f1f';
        b.style.color = '#fff';
        b.onclick = () => {
          if (prefsSalvas.has(nome)) prefsSalvas.delete(nome); else prefsSalvas.add(nome);
          localStorage.setItem('iflix_prefs', JSON.stringify([...prefsSalvas]));
          montarChipsPreferencias();
        };
        el.appendChild(b);
      });
      const msg = document.getElementById('prefs-msg');
      if (msg) {
        const arr = [...prefsSalvas];
        msg.textContent = arr.length ? 'PreferÃªncias salvas: ' + arr.join(', ') : 'Nenhuma preferÃªncia selecionada.';
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      atualizarNovidades();
      montarChipsPreferencias();
    });
  </script>
</body>
</html>
